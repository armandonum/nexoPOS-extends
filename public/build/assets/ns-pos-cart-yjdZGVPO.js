import{p as D,v as A,w as E,F as V,a as F,d as b,b as H,I as U,n as I,P as x}from"./bootstrap-DT6nawEL.js";import{_ as a,n as q}from"./currency-B1QCtbGi.js";import{s as M}from"./pos-section-switch-DmfccXVX.js";import{a as Q,d as Y,n as G,b as L,c as W,P as z}from"./ns-pos-shipping-popup-CPY9gnaD.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{o as i,c as d,a as s,t as r,r as f,f as y,B as K,F as m,b as k,g as S,w as C,i as O,e as p,h as T,aB as N,n as j,j as J}from"./runtime-core.esm-bundler-Bzup5G8m.js";import{b as X,a as Z,j as $,n as B}from"./ns-prompt-popup-DaSUNmqq.js";import"./chart-XFVd3zf7.js";import"./ns-orders-preview-popup-BV6ki60D.js";const ee={props:["order"],methods:{__,async payOrder(){POS.runPaymentQueue()}},mounted(){for(let t in nsShortcuts)["ns_pos_keyboard_payment"].includes(t)&&nsHotPress.create("ns_pos_keyboard_payment").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[t]!==null?nsShortcuts[t].join("+"):null,e=>{e.preventDefault(),this.payOrder()})},unmounted(){nsHotPress.destroy("ns_pos_keyboard_payment")}},te={class:"text-lg hidden md:inline lg:text-2xl"};function se(t,e,c,l,u,o){return i(),d("div",{onClick:e[0]||(e[0]=n=>o.payOrder()),id:"pay-button",class:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-green-500 text-white hover:bg-green-600 border-r border-green-600 flex-auto"},[e[1]||(e[1]=s("i",{class:"mr-2 text-2xl lg:text-xl las la-cash-register"},null,-1)),s("span",te,r(o.__("Pay")),1)])}const oe=P(ee,[["render",se]]),re={name:"ns-pos-hold-orders",props:["popup"],data(){return{order:{},title:"",show:!0}},mounted(){this.popupCloser(),this.show=POS.getHoldPopupEnabled(),this.show||this.popup.params.resolve({title:this.title}),this.$refs.reference.focus(),this.$refs.reference.select(),this.order=this.popup.params.order,this.title=this.popup.params.order.title||""},methods:{__:a,nsCurrency:q,popupCloser:D,submitHold(){this.popup.close(),this.popup.params.resolve({title:this.title})}}},ne={class:"ns-box shadow-lg w-6/7-screen md:w-3/7-screen lg:w-2/6-screen"},ie={class:"p-2 flex ns-box-header justify-between border-b items-center"},le={class:"font-semibold"},de={class:"flex-auto ns-box-body"},ae={class:"border-b h-16 flex items-center justify-center"},ue={class:"text-5xl text-primary"},ce={class:"p-2"},pe={class:"input-group border-2 info"},_e=["placeholder"],be={class:"p-2"},he={class:"text-secondary"},fe={class:"flex ns-box-footer"};function me(t,e,c,l,u,o){const n=f("ns-close-button");return i(),d("div",ne,[s("div",ie,[s("h3",le,r(o.__("Hold Order")),1),s("div",null,[y(n,{onClick:e[0]||(e[0]=_=>c.popup.close())})])]),s("div",de,[s("div",ae,[s("span",ue,r(o.nsCurrency(u.order.total)),1)]),s("div",ce,[s("div",pe,[K(s("input",{onKeyup:e[1]||(e[1]=E(_=>o.submitHold(),["enter"])),"onUpdate:modelValue":e[2]||(e[2]=_=>u.title=_),ref:"reference",type:"text",placeholder:o.__("Order Reference"),class:"outline-none rounded border-2 p-2 w-full"},null,40,_e),[[A,u.title]])])]),s("div",be,[s("p",he,r(o.__("The current order will be set on hold. You can retrieve this order from the pending order button. Providing a reference to it might help you to identify the order more quickly.")),1)])]),s("div",fe,[s("div",{onClick:e[3]||(e[3]=_=>o.submitHold()),class:"cursor-pointer w-1/2 py-3 flex justify-center items-center bg-green-500 text-white font-semibold"},r(o.__("Confirm")),1),s("div",{onClick:e[4]||(e[4]=_=>c.popup.close()),class:"cursor-pointer w-1/2 py-3 flex justify-center items-center bg-error-secondary text-white font-semibold"},r(o.__("Cancel")),1)])])}const ye=P(re,[["render",me]]),ve={props:["order"],methods:{__,async holdOrder(){if(this.order.payment_status!=="hold"&&this.order.payments.length>0)return nsSnackBar.error(__("Unable to hold an order which payment status has been updated already.")).subscribe();const t=nsHooks.applyFilters("ns-hold-queue",[ProductsQueue,CustomerQueue,TypeQueue]);for(let c in t)try{const u=await new t[c](this.order).run()}catch{return!1}nsHooks.applyFilters("ns-override-hold-popup",()=>{new Promise((l,u)=>{Popup.show(ye,{resolve:l,reject:u,order:this.order})}).then(l=>{this.order.title=l.title,this.order.payment_status="hold",POS.order.next(this.order);const u=Popup.show(X);POS.submitOrder().then(o=>{u.close(),nsSnackBar.success(o.message).subscribe()},o=>{u.close(),nsSnackBar.error(o.message).subscribe()})}).catch(l=>{console.log(l)})})()}},mounted(){for(let t in nsShortcuts)["ns_pos_keyboard_hold_order"].includes(t)&&nsHotPress.create("ns_pos_keyboard_hold_order").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[t]!==null?nsShortcuts[t].join("+"):null,e=>{e.preventDefault(),this.holdOrder()})},unmounted(){nsHotPress.destroy("ns_pos_keyboard_hold_order")}},xe={class:"text-lg hidden md:inline lg:text-2xl"};function ge(t,e,c,l,u,o){return i(),d("div",{onClick:e[0]||(e[0]=n=>o.holdOrder()),id:"hold-button",class:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-blue-500 text-white border-r hover:bg-blue-600 border-blue-600 flex-auto"},[e[1]||(e[1]=s("i",{class:"mr-2 text-2xl lg:text-xl las la-pause"},null,-1)),s("span",xe,r(o.__("Hold")),1)])}const we=P(ve,[["render",ge]]),Pe={props:["order","settings"],methods:{__,openDiscountPopup(t,e,c=null){if(!this.settings.products_discount&&e==="product")return nsSnackBar.error(__("You're not allowed to add a discount on the product.")).subscribe();if(!this.settings.cart_discount&&e==="cart")return nsSnackBar.error(__("You're not allowed to add a discount on the cart.")).subscribe();Popup.show(Q,{reference:t,type:e,onSubmit(l){e==="product"?POS.updateProduct(t,l,c):e==="cart"&&POS.updateCart(t,l)}},{popupClass:"bg-white h:2/3 shadow-lg xl:w-1/4 lg:w-2/5 md:w-2/3 w-full"})}}},ke={class:"text-lg hidden md:inline lg:text-2xl"};function Ce(t,e,c,l,u,o){return i(),d("div",{onClick:e[0]||(e[0]=n=>o.openDiscountPopup(c.order,"cart")),id:"discount-button",class:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center border-r border-box-edge flex-auto"},[e[1]||(e[1]=s("i",{class:"mr-2 text-2xl lg:text-xl las la-percent"},null,-1)),s("span",ke,r(o.__("Discount")),1)])}const Se=P(Pe,[["render",Ce]]),Oe={props:["order","settings"],methods:{__,voidOngoingOrder(){POS.voidOrder(this.order)}}},Te={class:"text-lg hidden md:inline lg:text-2xl"};function je(t,e,c,l,u,o){return i(),d("div",{onClick:e[0]||(e[0]=n=>o.voidOngoingOrder(c.order)),id:"void-button",class:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-red-500 text-white border-box-edge hover:bg-red-600 flex-auto"},[e[1]||(e[1]=s("i",{class:"mr-2 text-2xl lg:text-xl las la-trash"},null,-1)),s("span",Te,r(o.__("Void")),1)])}const Ne=P(Oe,[["render",je]]),De={name:"ns-pos-note-popup",props:["popup"],data(){return{validation:new V,fields:[{label:a("Note"),name:"note",value:"",description:a("More details about this order"),type:"textarea"},{label:a("Display On Receipt"),name:"note_visibility",value:"",options:[{label:a("Yes"),value:"visible"},{label:a("No"),value:"hidden"}],description:a("Will display the note on the receipt"),type:"switch"}]}},mounted(){this.popupCloser(),this.fields.forEach(t=>{t.name==="note"?t.value=this.popup.params.note:t.name==="note_visibility"&&(t.value=this.popup.params.note_visibility)})},methods:{__:a,popupResolver:F,popupCloser:D,closePopup(){this.popupResolver(!1)},saveNote(){if(!this.validation.validateFields(this.fields)){const t=this.validation.validateFieldsErrors(this.fields);return this.validation.triggerFieldsErrors(this.fields,t),this.$forceUpdate(),b.error(a("Unable to proceed the form is not valid.")).subscribe()}return this.popupResolver(this.validation.extractFields(this.fields))}}},Ve={class:"shadow-lg ns-box w-95vw md:w-3/5-screen lg:w-2/5-screen"},qe={class:"p-2 flex justify-between items-center border-b ns-box-header"},Be={class:"font-bold"},Fe={class:"p-2"},He={class:"p-2 flex justify-end border-t ns-box-footer"};function Qe(t,e,c,l,u,o){const n=f("ns-close-button"),_=f("ns-field"),h=f("ns-button");return i(),d("div",Ve,[s("div",qe,[s("h3",Be,r(o.__("Order Note")),1),s("div",null,[y(n,{onClick:e[0]||(e[0]=v=>o.closePopup())})])]),s("div",Fe,[(i(!0),d(m,null,k(u.fields,(v,g)=>(i(),S(_,{key:g,field:v},null,8,["field"]))),128))]),s("div",He,[y(h,{type:"info",onClick:e[1]||(e[1]=v=>o.saveNote())},{default:C(()=>[O(r(o.__("Save")),1)]),_:1})])])}const Re=P(De,[["render",Qe]]),Ae={name:"ns-pos-tax-popup",props:["popup"],data(){return{validation:new V,tax_group:[],order:null,orderSubscriber:null,optionsSubscriber:null,options:{},tax_group:[],activeTab:"",group_fields:[{label:a("Select Tax"),name:"tax_group_id",description:a("Define the tax that apply to the sale."),type:"select",disabled:!0,value:"",validation:"required",options:[]},{label:a("Type"),name:"tax_type",disabled:!0,value:"",description:a("Define how the tax is computed"),type:"select",validation:"required",options:[{label:a("Exclusive"),value:"exclusive"},{label:a("Inclusive"),value:"inclusive"}]}]}},mounted(){this.loadGroups(),this.popupCloser(),this.activeTab=this.popup.params.activeTab||"settings",this.group_fields.forEach(t=>{t.value=this.popup.params[t.name]||void 0}),this.orderSubscriber=POS.order.subscribe(t=>{this.order=t}),this.optionsSubscriber=POS.options.subscribe(t=>{this.options=t,["variable_vat","products_variable_vat"].includes(this.options.ns_pos_vat)&&this.group_fields.forEach(e=>e.disabled=!1)})},unmounted(){this.orderSubscriber.unsubscribe(),this.optionsSubscriber.unsubscribe()},methods:{__:a,nsCurrency:q,popupCloser:D,popupResolver:F,changeActive(t){this.activeTab=t},closePopup(){this.popupResolver(!1)},saveTax(){if(!this.validation.validateFields(this.group_fields))return b.error(a("Unable to proceed the form is not valid.")).subscribe();const t=this.validation.extractFields(this.group_fields);t.tax_group={},this.popupResolver(t)},loadGroups(){H.get("/api/taxes/groups").subscribe(t=>{this.groups=t,this.group_fields.forEach(e=>{e.name==="tax_group_id"&&(e.options=this.groups.map(c=>({label:c.name,value:c.id})))})})}}},Ee={class:"ns-box shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen"},Ue={class:"p-2 flex justify-between items-center border-b ns-box-header"},Ie={class:"text-blog"},Me={class:"p-2 ns-box-body"},Ye={class:"p-2 border-b ns-box-body"},Ge={class:"flex justify-end p-2"},Le={key:0,class:"p-2"},We={key:0,class:"p-2 text-center text-primary"},ze={key:0,class:"p-2"},Ke={class:"border shadow p-2 w-full flex justify-between items-center elevation-surface"};function Je(t,e,c,l,u,o){const n=f("ns-close-button"),_=f("ns-field"),h=f("ns-button"),v=f("ns-tabs-item"),g=f("ns-tabs");return i(),d("div",Ee,[s("div",Ue,[s("h3",Ie,r(o.__("Tax & Summary")),1),s("div",null,[y(n,{onClick:e[0]||(e[0]=w=>o.closePopup())})])]),s("div",Me,[Object.keys(u.options).length>0?(i(),S(g,{key:0,active:u.activeTab,onChangeTab:e[2]||(e[2]=w=>o.changeActive(w))},{default:C(()=>[y(v,{padding:"0",label:o.__("Settings"),identifier:"settings",active:!0},{default:C(()=>[s("div",Ye,[(i(!0),d(m,null,k(u.group_fields,(w,R)=>(i(),S(_,{field:w,key:R},null,8,["field"]))),128))]),s("div",Ge,[y(h,{onClick:e[1]||(e[1]=w=>o.saveTax()),type:"info"},{default:C(()=>[O(r(o.__("Save")),1)]),_:1})])]),_:1},8,["label"]),y(v,{padding:"0",label:o.__("Summary"),identifier:"summary",active:!1},{default:C(()=>[u.order?(i(),d("div",Le,[(i(!0),d(m,null,k(u.order.taxes,w=>(i(),d("div",{key:w.id,class:"mb-2 border shadow p-2 w-full flex justify-between items-center elevation-surface"},[s("span",null,r(w.name),1),s("span",null,r(o.nsCurrency(w.tax_value)),1)]))),128)),u.order.taxes.length===0?(i(),d("div",We,r(o.__("No tax is active")),1)):p("",!0)])):p("",!0)]),_:1},8,["label"]),["products_vat"].includes(u.options.ns_pos_vat)?(i(),S(v,{key:0,padding:"0",label:o.__("Product Taxes"),identifier:"product_taxes",active:!1},{default:C(()=>[u.order?(i(),d("div",ze,[s("div",Ke,[s("span",null,r(o.__("Product Taxes")),1),s("span",null,r(o.nsCurrency(u.order.products_tax_value)),1)])])):p("",!0)]),_:1},8,["label"])):p("",!0)]),_:1},8,["active"])):p("",!0)])])}const Xe=P(Ae,[["render",Je]]),Ze={name:"ns-pos-order-settings",props:["popup"],mounted(){nsHttpClient.get("/api/fields/ns.pos-order-settings").subscribe(t=>{t.forEach(e=>{e.value=this.popup.params.order[e.name]||""}),this.fields=this.validation.createFields(t)},t=>{}),this.popupCloser()},data(){return{fields:[],validation:new V}},methods:{__,popupCloser,popupResolver,closePopup(){this.popupResolver(!1)},saveSettings(){const t=this.validation.extractFields(this.fields);this.popupResolver(t)}}},$e={class:"shadow-lg flex flex-col ns-box w-95vw h-95vh md:w-3/5-screen md:h-3/5-screen lg:w-2/5-screen"},et={class:"p-2 border-b ns-box-header items-center flex justify-between"},tt={class:"text-semibold"},st={class:"p-2 flex-auto border-b ns-box-body overflow-y-auto"},ot={class:"p-2 flex justify-end ns-box-footer"};function rt(t,e,c,l,u,o){const n=f("ns-close-button"),_=f("ns-field"),h=f("ns-button");return i(),d("div",$e,[s("div",et,[s("h3",tt,r(o.__("Order Settings")),1),s("div",null,[y(n,{onClick:e[0]||(e[0]=v=>o.closePopup())})])]),s("div",st,[(i(!0),d(m,null,k(u.fields,(v,g)=>(i(),S(_,{field:v,key:g},null,8,["field"]))),128))]),s("div",ot,[y(h,{onClick:e[1]||(e[1]=v=>o.saveSettings()),type:"info"},{default:C(()=>[O(r(o.__("Save")),1)]),_:1})])])}const nt=P(Ze,[["render",rt]]),it={name:"ns-pos-product-price-product",props:["popup"],components:{nsNumpad:Z,nsNumpadPlus:$},computed:{},data(){return{product:{},optionsSubscription:null,options:{},price:0}},mounted(){this.popupCloser(),this.product=this.popup.params.product,this.optionsSubscription=POS.options.subscribe(t=>{this.options=T(t)})},beforeDestroy(){this.optionsSubscription.unsubscribe()},methods:{popupResolver,popupCloser,nsCurrency:q,__,updateProductPrice(t){this.product.unit_price=t},resolveProductPrice(t){this.popupResolver(this.product.unit_price)}}},lt={class:"ns-box shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen"},dt={class:"popup-heading ns-box-header"},at={class:"flex flex-col ns-box-body"},ut={class:"h-16 flex items-center justify-center elevation-surface info font-bold"},ct={class:"text-2xl"};function pt(t,e,c,l,u,o){const n=f("ns-close-button"),_=f("ns-numpad");return i(),d("div",lt,[s("div",dt,[s("h3",null,r(o.__("Product Price")),1),s("div",null,[y(n,{onClick:e[0]||(e[0]=h=>o.popupResolver(!1))})])]),s("div",at,[s("div",ut,[s("h2",ct,r(o.nsCurrency(u.product.unit_price)),1)]),y(_,{floating:!0,onChanged:e[1]||(e[1]=h=>o.updateProductPrice(h)),onNext:e[2]||(e[2]=h=>o.resolveProductPrice(h)),value:u.product.unit_price},null,8,["value"])])])}const _t=P(it,[["render",pt]]),bt={name:"ns-pos-quick-product-popup",props:["popup"],methods:{__:a,popupCloser:D,popupResolver:F,close(){this.popupResolver(!1)},async addProduct(){const t=this.validation.extractFields(this.fields),e=this.fields.filter(o=>typeof o.show>"u"||typeof o.show=="function"&&o.show(t));if(!this.validation.validateFields(e))return b.error(a("Unable to proceed. The form is not valid.")).subscribe();let l=this.validation.extractFields(e);l.$original=()=>({stock_management:"disabled",category_id:0,tax_group:this.tax_groups.filter(o=>parseInt(o.id)===parseInt(l.tax_group_id))[0],tax_group_id:l.tax_group_id,tax_type:l.tax_type}),l.product_type==="product"?(l.unit_name=this.units.filter(o=>o.id===l.unit_id)[0].name,l.quantity=parseFloat(l.quantity),l.unit_price=parseFloat(l.unit_price),l.mode="custom",l.price_with_tax=l.unit_price,l.price_without_tax=l.unit_price,l.tax_value=0):(l.unit_name=a("N/A"),l.unit_price=0,l.quantity=1);const u=await POS.defineQuantities(l,this.units);l.$quantities=()=>u,l=POS.computeProductTax(l),POS.addToCart(l),this.close()},loadData(){this.loaded=!1,U(nsHttpClient.get("/api/units"),nsHttpClient.get("/api/taxes/groups")).subscribe({next:t=>{this.units=t[0],this.tax_groups=t[1],this.fields.filter(e=>{e.name==="tax_group_id"&&(e.options=t[1].map(c=>({label:c.name,value:c.id})),t[1].length>0&&t[1][0].id!==void 0&&(e.value=t[1][0].id||this.options.ns_pos_tax_group)),e.name==="tax_type"&&(e.value=this.options.tax_type||"inclusive"),e.name==="unit_id"&&(e.value=this.options.ns_pos_quick_product_default_unit,e.options=t[0].map(c=>({label:c.name,value:c.id})))}),this.buildForm()},error:t=>{}})},buildForm(){this.fields=this.validation.createFields(this.fields),this.loaded=!0,setTimeout(()=>{this.$el.querySelector("#name").select()},100)}},computed:{form(){return this.validation.extractFields(this.fields)}},data(){return{units:[],options:POS.options.getValue(),tax_group:{},loaded:!1,validation:new V,fields:[{label:a("Name"),name:"name",type:"text",description:a("Provide a unique name for the product."),validation:"required"},{label:a("Product Type"),name:"product_type",type:"select",description:a("Define the product type."),options:[{label:a("Normal"),value:"product"},{label:a("Dynamic"),value:"dynamic"}],value:"product",validation:"required"},{label:a("Rate"),name:"rate",type:"text",description:a("In case the product is computed based on a percentage, define the rate here."),validation:"required",show(t){return t.product_type==="dynamic"}},{label:a("Unit Price"),name:"unit_price",type:"text",description:a("Define what is the sale price of the item."),validation:"",value:0,show(t){return t.product_type==="product"}},{label:a("Quantity"),name:"quantity",type:"text",value:1,description:a("Set the quantity of the product."),validation:"",show(t){return t.product_type==="product"}},{label:a("Unit"),name:"unit_id",type:"select",options:[],description:a("Assign a unit to the product."),validation:"",show(t){return t.product_type==="product"}},{label:a("Tax Type"),name:"tax_type",type:"select",options:[{label:a("Disabled"),value:""},{label:a("Inclusive"),value:"inclusive"},{label:a("Exclusive"),value:"exclusive"}],description:a("Define what is tax type of the item."),show(t){return t.product_type==="product"}},{label:a("Tax Group"),name:"tax_group_id",type:"select",options:[],description:a("Choose the tax group that should apply to the item."),show(t){return t.product_type==="product"}}]}},mounted(){this.popupCloser(),this.loadData()}},ht={class:"w-95vw flex flex-col h-95vh shadow-lg md:w-3/5-screen lg:w-2/5-screen md:h-3/5-screen ns-box"},ft={class:"header ns-box-header border-b flex justify-between p-2 items-center"},mt={class:"ns-box-body p-2 flex-auto overflow-y-auto"},yt={key:0,class:"h-full w-full flex justify-center items-center"},vt={class:"ns-box-footer border-t flex justify-between p-2"};function xt(t,e,c,l,u,o){const n=f("ns-close-button"),_=f("ns-spinner"),h=f("ns-field"),v=f("ns-button");return i(),d("div",ht,[s("div",ft,[s("h3",null,r(o.__("Product / Service")),1),s("div",null,[y(n,{onClick:e[0]||(e[0]=g=>o.close())})])]),s("div",mt,[u.loaded?p("",!0):(i(),d("div",yt,[y(_)])),u.loaded?(i(!0),d(m,{key:1},k(u.fields,(g,w)=>(i(),d(m,null,[g.show&&g.show(o.form)||!g.show?(i(),S(h,{key:w,field:g},null,8,["field"])):p("",!0)],64))),256)):p("",!0)]),s("div",vt,[e[2]||(e[2]=s("div",null,null,-1)),s("div",null,[y(v,{onClick:e[1]||(e[1]=g=>o.addProduct()),type:"info"},{default:C(()=>[O(r(o.__("Create")),1)]),_:1})])])])}const gt=P(bt,[["render",xt]]),wt={name:"ns-pos-cart",data:()=>({popup:null,cartButtons:{},products:[],defaultCartButtons:{nsPosPayButton:N(oe),nsPosHoldButton:N(we),nsPosDiscountButton:N(Se),nsPosVoidButton:N(Ne)},visibleSection:null,visibleSectionSubscriber:null,cartButtonsSubscriber:null,optionsSubscriber:null,options:{},typeSubscribe:null,orderSubscribe:null,productSubscribe:null,settingsSubscribe:null,settings:{},types:[],order:T({}),showOffers:!1,offers:[],loadingOffers:!1}),computed:{selectedType(){return this.order.type?this.order.type.label:"N/A"},isVisible(){return this.visibleSection==="cart"},customerName(){return this.order.customer?`${this.order.customer.first_name||this.order.customer.last_name?this.getFirstName():this.getUserName()}`:"N/A"},couponName(){return a("Apply Coupon")},sortedOffers(){return[...this.offers].sort((t,e)=>t.dias_restantes-e.dias_restantes)}},mounted(){this.cartButtonsSubscriber=POS.cartButtons.subscribe(t=>{this.cartButtons=t}),this.optionsSubscriber=POS.options.subscribe(t=>{this.options=t}),this.typeSubscribe=POS.types.subscribe(t=>this.types=t),this.orderSubscribe=POS.order.subscribe(t=>{this.order=T(t)}),this.productSubscribe=POS.products.subscribe(t=>{this.products=T(t)}),this.settingsSubscribe=POS.settings.subscribe(t=>{this.settings=T(t)}),this.visibleSectionSubscriber=POS.visibleSection.subscribe(t=>{this.visibleSection=T(t)}),I.addAction("ns-before-cart-reset","ns-pos-cart-buttons",()=>{POS.cartButtons.next(this.defaultCartButtons)});for(let t in nsShortcuts)["ns_pos_keyboard_shipping"].includes(t)&&nsHotPress.create("ns_pos_keyboard_shipping").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[t]!==null?nsShortcuts[t].join("+"):null,e=>{e.preventDefault(),this.openShippingPopup()}),["ns_pos_keyboard_note"].includes(t)&&nsHotPress.create("ns_pos_keyboard_note").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[t]!==null?nsShortcuts[t].join("+"):null,e=>{e.preventDefault(),this.openNotePopup()})},unmounted(){this.visibleSectionSubscriber.unsubscribe(),this.typeSubscribe.unsubscribe(),this.orderSubscribe.unsubscribe(),this.productSubscribe.unsubscribe(),this.settingsSubscribe.unsubscribe(),this.optionsSubscriber.unsubscribe(),this.cartButtonsSubscriber.unsubscribe(),nsHotPress.destroy("ns_pos_keyboard_shipping"),nsHotPress.destroy("ns_pos_keyboard_note")},methods:{__:a,nsCurrency:q,switchTo:M,getFirstName(){return`${this.order.customer.first_name||""} ${this.order.customer.last_name||""}`},getUserName(){return this.order.customer.username},takeRandomClass(){return"border-gray-500 bg-gray-400 text-white hover:bg-gray-500"},openAddQuickProduct(){new Promise((e,c)=>{x.show(gt,{resolve:e,reject:c})}).then(e=>{}).catch(e=>{})},summarizeCoupons(){const t=this.order.coupons.map(e=>e.value);return t.length>0?t.reduce((e,c)=>e+c):0},async changeProductPrice(t){if(!this.settings.edit_purchase_price)return b.error(a("You don't have the right to edit the purchase price.")).subscribe();if(t.product_type==="dynamic")return b.error(a("Dynamic product can't have their price updated.")).subscribe();if(this.settings.unit_price_editable)try{const e=await new Promise((l,u)=>x.show(_t,{product:Object.assign({},t),resolve:l,reject:u})),c={...t.$quantities(),custom_price_edit:e,custom_price_with_tax:e,custom_price_without_tax:e};return t.$quantities=()=>c,t.mode="custom",POS.recomputeProducts(POS.products.getValue()),POS.refreshCart(),b.success(a("The product price has been updated.")).subscribe()}catch(e){if(e!==!1)throw b.error(e).subscribe(),e}else return b.error(a("The editable price feature is disabled.")).subscribe()},async selectCoupon(){try{const t=await new Promise((e,c)=>{x.show(Y,{resolve:e,reject:c})})}catch{}},async defineOrderSettings(){if(!this.settings.edit_settings)return b.error(a("You're not allowed to edit the order settings.")).subscribe();try{const t=await new Promise((e,c)=>{x.show(nt,{resolve:e,reject:c,order:this.order})});POS.order.next({...this.order,...t})}catch{}},async openNotePopup(){try{const t=await new Promise((c,l)=>{const u=this.order.note,o=this.order.note_visibility;x.show(Re,{resolve:c,reject:l,note:u,note_visibility:o})}),e={...this.order,...t};POS.order.next(e)}catch(t){t!==!1&&b.error(t.message).subscribe()}},async selectTaxGroup(t="settings"){try{const e=await new Promise((l,u)=>{const o=this.order.taxes,n=this.order.tax_group_id,_=this.order.tax_type;x.show(Xe,{resolve:l,reject:u,taxes:o,tax_group_id:n,tax_type:_,activeTab:t})}),c={...this.order,...e};POS.order.next(c),POS.refreshCart()}catch{}},openTaxSummary(){this.selectTaxGroup("summary")},selectCustomer(){x.show(G)},async openDiscountPopup(t,e,c=null){if(!this.settings.products_discount&&e==="product")return b.error(a("You're not allowed to add a discount on the product.")).subscribe();if(!this.settings.cart_discount&&e==="cart")return b.error(a("You're not allowed to add a discount on the cart.")).subscribe();e==="product"&&(t.disable_flat=!0);try{const l=await new Promise((u,o)=>{x.show(Q,{reference:t,resolve:u,reject:o,type:e,onSubmit(n){if(n.discount_type==="flat"&&n.discount>t.total_price)return b.error(a("The discount amount can't exceed the total price of the product.")).subscribe();e==="product"?POS.updateProduct(t,n,c):e==="cart"&&POS.updateCart(t,n)}},{popupClass:"bg-white h:2/3 shadow-lg xl:w-1/4 lg:w-2/5 md:w-2/3 w-full"})})}catch{}},toggleMode(t,e){if(!this.options.ns_pos_allow_wholesale_price)return b.error(a("Unable to change the price mode. This feature has been disabled.")).subscribe();t.mode==="normal"?x.show(B,{title:a("Enable WholeSale Price"),message:a("Would you like to switch to wholesale price ?"),onAction(c){c&&POS.updateProduct(t,{mode:"wholesale"},e)}}):x.show(B,{title:a("Enable Normal Price"),message:a("Would you like to switch to normal price ?"),onAction(c){c&&POS.updateProduct(t,{mode:"normal"},e)}})},removeUsingIndex(t){x.show(B,{title:a("Confirm Your Action"),message:a("Would you like to delete this product ?"),onAction(e){e&&POS.removeProductUsingIndex(t)}})},allowQuantityModification(t){return t.product_type==="product"},changeQuantity(t,e){this.allowQuantityModification(t)&&new z(t).run({unit_quantity_id:t.unit_quantity_id,unit_name:t.unit_name,$quantities:t.$quantities}).then(l=>{POS.updateProduct(t,l,e)})},openOrderType(){x.show(L)},openShippingPopup(){x.show(W)},async toggleOffersView(){console.log("Activar o desactivar la vista de ofertas:"),this.showOffers=!this.showOffers,this.showOffers&&(console.log("Loading offers..."),await this.loadOffers())},async loadOffers(){this.loadingOffers=!0;try{const t=await new Promise((e,c)=>{H.get("/api/ofertas/activas").subscribe({next:l=>{console.log("Response completa:",l),console.log("Ofertas:",l.data),l.data&&l.data.length>0&&console.log("Productos en primera oferta:",l.data[0].productos),e(l)},error:l=>{console.error("Error:",l),c(l)}})});t&&t.data&&(this.offers=t.data,console.log("Ofertas cargadas:",this.offers))}catch(t){console.error("Error loading offers:",t),b.error(a("No se pudieron cargar las ofertas")).subscribe()}finally{this.loadingOffers=!1}},formatDate(t){return new Date(t).toLocaleDateString()},async selectOffer(t){try{const e=this.products,l=t.productos.filter(o=>!e.some(n=>n.id===o.id));if(l.length>0){const o=l.map(n=>n.name).join(", ");b.error(a(`Por favor, añade los siguientes productos al carrito primero: ${o}`)).subscribe();return}const u={...this.order};u.discount_type="percentage",u.discount_percentage=t.porcentaje_descuento,u.discount=u.subtotal*t.porcentaje_descuento/100,u.applied_offer=t.id,POS.order.next(u),POS.refreshCart(),b.success(a("Offer applied successfully: ")+t.nombre).subscribe(),this.showOffers=!1}catch{b.error(a("Unable to apply offer")).subscribe()}},async applyOffer(t){try{const e=this.products;if(!t.productos.every(n=>e.some(_=>_.id===n.id))){b.error(a("All offer products must be in cart")).subscribe();return}const u=t.porcentaje_descuento,o={...this.order};o.discount_type="percentage",o.discount_percentage=u,o.discount=o.subtotal*u/100,POS.order.next(o),POS.refreshCart(),b.success(a("Offer applied successfully")).subscribe(),this.showOffers=!1}catch{b.error(a("Unable to apply offer")).subscribe()}}}},Pt={id:"pos-cart",class:"flex-auto flex flex-col h-full"},kt={key:0,id:"tools",class:"flex pl-2 ns-tab"},Ct={key:0,class:"flex items-center justify-center text-sm rounded-full h-6 w-6 bg-green-500 text-white ml-1"},St={class:"rounded shadow ns-tab-item flex-auto flex overflow-hidden"},Ot={class:"cart-table flex flex-auto flex-col overflow-hidden"},Tt={id:"cart-toolbox",class:"w-full p-2 border-b"},jt={class:"border rounded overflow-hidden"},Nt={class:"flex flex-wrap"},Dt={class:"ns-button"},Vt={class:"ml-1 hidden md:inline-block"},qt={class:"ns-button"},Bt={class:"ml-1 hidden md:inline-block"},Ft={key:0,class:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-info-secondary text-white"},Ht={class:"ns-button"},Qt={class:"ml-1 hidden md:inline-block"},Rt={key:0,class:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-info-secondary text-white"},At={class:"ns-button"},Et={class:"ml-1 hidden md:inline-block"},Ut={key:0,class:"ns-button"},It={class:"ml-1 hidden md:inline-block"},Mt={class:"ns-button"},Yt={class:"ml-1 hidden md:inline-block"},Gt={class:"container-pos flex flex-col flex-grow overflow-y-auto"},Lt={key:0,class:"flex flex-col flex-grow overflow-y-auto"},Wt={id:"cart-table-header",class:"w-full text-primary font-semibold flex"},zt={class:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0"},Kt={class:"hidden lg:flex lg:w-1/6 p-2 border-b border-t-0"},Jt={class:"hidden lg:flex lg:w-1/6 p-2 border border-r-0 border-t-0"},Xt={id:"cart-products-table",class:"flex flex-auto flex-col overflow-auto"},Zt={key:0,class:"text-primary flex"},$t={class:"w-full text-center py-4 border-b"},es=["product-index"],ts={class:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0"},ss={class:"flex justify-between product-details mb-1"},os={class:"font-semibold"},rs={class:"-mx-1 flex product-options"},ns={class:"px-1"},is=["onClick"],ls={key:0,class:"px-1"},ds=["onClick"],as={class:"flex justify-between product-controls"},us={class:"-mx-1 flex flex-wrap"},cs={class:"px-1 w-1/2 md:w-auto mb-1"},ps=["onClick"],_s={class:"px-1 w-1/2 md:w-auto mb-1"},bs=["onClick"],hs={key:0},fs={class:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},ms=["onClick"],ys={class:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},vs={class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},xs=["onClick"],gs={key:0,class:"border-b border-dashed border-info-primary p-2"},ws={class:"hidden lg:flex w-1/6 p-2 border border-r-0 border-t-0 items-center justify-center"},Ps={id:"cart-products-summary",class:"flex"},ks={key:0,class:"table ns-table w-full text-sm"},Cs={key:0},Ss={width:"200",class:"border p-2",colspan:"2"},Os={class:"py-1"},Ts={width:"200",class:"border p-2 text-right"},js={width:"200",class:"border p-2"},Ns={width:"200",class:"border p-2"},Ds={width:"200",class:"border p-2 text-right"},Vs={key:1},qs={width:"200",class:"border p-2"},Bs={width:"200",class:"border p-2 text-right"},Fs={width:"200",class:"border p-2"},Hs={width:"200",class:"border p-2"},Qs={key:0},Rs={key:1},As={width:"200",class:"border p-2 text-right"},Es={key:2},Us={width:"200",class:"border p-2"},Is={width:"200",class:"border p-2 text-right"},Ms={class:"success"},Ys={key:0,width:"200",class:"border p-2"},Gs={key:1,width:"200",class:"border p-2"},Ls={width:"200",class:"border p-2"},Ws={width:"200",class:"border p-2 text-right"},zs={key:1,class:"table ns-table w-full text-sm"},Ks={width:"200",class:"border p-2"},Js={width:"200",class:"border p-2"},Xs={class:"flex justify-between"},Zs={key:0},$s={width:"200",class:"border p-2"},eo={width:"200",class:"border p-2 text-right"},to={width:"200",class:"border p-2"},so={width:"200",class:"border p-2"},oo={class:"flex justify-between items-center"},ro={key:0},no={key:1},io={key:1},lo={width:"200",class:"border p-2"},ao={class:"success"},uo={width:"200",class:"border p-2"},co={width:"200",class:"border p-2"},po={class:"flex justify-between w-full"},_o={class:"h-16 flex flex-shrink-0 border-t border-box-edge",id:"cart-bottom-buttons"},bo={key:1,class:"p-4"},ho={key:0,class:"flex justify-center items-center h-32"},fo={key:1,class:"text-center py-8"},mo={class:"text-gray-500"},yo={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4"},vo={class:"border-b pb-3 mb-3"},xo={class:"text-lg font-bold text-gray-800"},go={class:"text-gray-600 mt-1"},wo={class:"flex justify-between items-center mt-2"},Po={class:"text-sm text-gray-500"},ko={class:"text-sm font-medium text-blue-600"},Co={key:0,class:"mt-2 p-2 bg-red-100 border border-red-200 rounded-md"},So={class:"text-red-700 text-sm font-medium flex items-center"},Oo={key:0,class:"space-y-2"},To={class:"font-medium text-gray-700"},jo={class:"divide-y"},No={class:"text-sm text-gray-600"},Do={class:"text-sm text-green-600"},Vo={key:1,class:"text-center text-gray-500 py-2"},qo={class:"mt-4 flex justify-end"};function Bo(t,e,c,l,u,o){return i(),d("div",Pt,[t.visibleSection==="cart"?(i(),d("div",kt,[s("div",{onClick:e[0]||(e[0]=n=>o.switchTo("cart")),class:"flex cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 font-semibold active tab"},[s("span",null,r(o.__("Cart")),1),t.order?(i(),d("span",Ct,r(t.order.products.length),1)):p("",!0)]),s("div",{onClick:e[1]||(e[1]=n=>o.switchTo("grid")),class:"cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 border-t border-r border-l inactive tab"},r(o.__("Products")),1)])):p("",!0),s("div",St,[s("div",Ot,[s("div",Tt,[s("div",jt,[s("div",Nt,[s("div",Dt,[s("button",{onClick:e[2]||(e[2]=n=>o.openNotePopup()),class:"w-full h-10 px-3 outline-none"},[e[24]||(e[24]=s("i",{class:"las la-comment"},null,-1)),s("span",Vt,r(o.__("Comments")),1)])]),e[30]||(e[30]=s("hr",{class:"h-10",style:{width:"1px"}},null,-1)),s("div",qt,[s("button",{onClick:e[3]||(e[3]=n=>o.selectTaxGroup()),class:"w-full h-10 px-3 outline-none flex items-center"},[e[25]||(e[25]=s("i",{class:"las la-balance-scale-left"},null,-1)),s("span",Bt,r(o.__("Taxes")),1),t.order.taxes&&t.order.taxes.length>0?(i(),d("span",Ft,r(t.order.taxes.length),1)):p("",!0)])]),e[31]||(e[31]=s("hr",{class:"h-10",style:{width:"1px"}},null,-1)),s("div",Ht,[s("button",{onClick:e[4]||(e[4]=n=>o.selectCoupon()),class:"w-full h-10 px-3 outline-none flex items-center"},[e[26]||(e[26]=s("i",{class:"las la-tags"},null,-1)),s("span",Qt,r(o.__("Coupons")),1),t.order.coupons&&t.order.coupons.length>0?(i(),d("span",Rt,r(t.order.coupons.length),1)):p("",!0)])]),e[32]||(e[32]=s("hr",{class:"h-10",style:{width:"1px"}},null,-1)),s("div",At,[s("button",{onClick:e[5]||(e[5]=n=>o.defineOrderSettings()),class:"w-full h-10 px-3 outline-none flex items-center"},[e[27]||(e[27]=s("i",{class:"las la-tools"},null,-1)),s("span",Et,r(o.__("Settings")),1)])]),e[33]||(e[33]=s("hr",{class:"h-10",style:{width:"1px"}},null,-1)),t.options.ns_pos_quick_product==="yes"?(i(),d("div",Ut,[s("button",{onClick:e[6]||(e[6]=n=>o.openAddQuickProduct()),class:"w-full h-10 px-3 outline-none flex items-center"},[e[28]||(e[28]=s("i",{class:"las la-plus"},null,-1)),s("span",It,r(o.__("Product")),1)])])):p("",!0),e[34]||(e[34]=s("hr",{class:"h-10",style:{width:"1px"}},null,-1)),e[35]||(e[35]=s("div",{class:"w-px h-10 bg-gray-300"},null,-1)),s("div",Mt,[s("button",{onClick:e[7]||(e[7]=(...n)=>o.toggleOffersView&&o.toggleOffersView(...n)),class:"w-full h-10 px-3 outline-none flex items-center"},[e[29]||(e[29]=s("i",{class:"las la-gift"},null,-1)),s("span",Yt,r(o.__("Ofertas disponibles")),1)])])])])]),s("div",Gt,[t.showOffers?(i(),d("div",bo,[t.loadingOffers?(i(),d("div",ho,e[44]||(e[44]=[s("i",{class:"las la-spinner animate-spin text-6xl"},null,-1)]))):t.offers.length===0?(i(),d("div",fo,[s("p",mo,r(o.__("No hay ofertas activas disponibles")),1)])):(i(),d("div",yo,[(i(!0),d(m,null,k(o.sortedOffers,n=>(i(),d("div",{key:n.id,class:j(["border rounded-lg p-4 shadow-sm transition-colors duration-200",n.dias_restantes<=5?"bg-red-50":"bg-white"])},[s("div",vo,[s("h3",xo,r(n.nombre),1),s("p",go,r(n.descripcion),1),s("div",wo,[s("span",Po,r(o.__("Válido hasta"))+": "+r(o.formatDate(n.fecha_final)),1),s("span",ko,r(n.tipo_oferta.nombre),1)]),n.dias_restantes<=5?(i(),d("div",Co,[s("p",So,[e[45]||(e[45]=s("i",{class:"las la-clock mr-2"},null,-1)),O(" "+r(n.dias_restantes===0?o.__("¡Último día!"):o.__(`Faltan ${n.dias_restantes} día(s) para concluir`)),1)])])):p("",!0)]),n.productos&&n.productos.length>0?(i(),d("div",Oo,[s("h4",To,r(o.__("Productos incluidos"))+":",1),s("ul",jo,[(i(!0),d(m,null,k(n.productos,_=>(i(),d("li",{key:_.id,class:"py-2 flex justify-between items-center"},[s("span",No,r(_.name),1),s("span",Do,r(o.nsCurrency(_.price)),1)]))),128))])])):(i(),d("div",Vo,r(o.__("No hay productos en esta oferta")),1))],2))),128))])),s("div",qo,[s("button",{onClick:e[23]||(e[23]=n=>t.showOffers=!1),class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg text-gray-700"},r(o.__("Volver atrás")),1)])])):(i(),d("div",Lt,[s("div",Wt,[s("div",zt,r(o.__("Product")),1),s("div",Kt,r(o.__("Quantity")),1),s("div",Jt,r(o.__("Total")),1)]),s("div",Xt,[t.products.length===0?(i(),d("div",Zt,[s("div",$t,[s("h3",null,r(o.__("No products added...")),1)])])):p("",!0),(i(!0),d(m,null,k(t.products,(n,_)=>(i(),d("div",{"product-index":_,key:n.barcode,class:"product-item flex"},[s("div",ts,[s("div",ss,[s("h3",os,r(n.name)+" — "+r(n.unit_name),1),s("div",rs,[s("div",ns,[s("a",{onClick:h=>o.removeUsingIndex(_),class:"hover:text-error-secondary cursor-pointer outline-none border-dashed py-1 border-b border-error-secondary text-sm"},e[36]||(e[36]=[s("i",{class:"las la-trash text-xl"},null,-1)]),8,is)]),t.options.ns_pos_allow_wholesale_price&&o.allowQuantityModification(n)?(i(),d("div",ls,[s("a",{class:j([n.mode==="wholesale"?"text-success-secondary border-success-secondary":"border-info-primary","cursor-pointer outline-none border-dashed py-1 border-b text-sm"]),onClick:h=>o.toggleMode(n,_)},e[37]||(e[37]=[s("i",{class:"las la-award text-xl"},null,-1)]),10,ds)])):p("",!0)])]),s("div",as,[s("div",us,[s("div",cs,[s("a",{onClick:h=>o.changeProductPrice(n),class:j([n.mode==="wholesale"?"text-success-secondary hover:text-success-secondary border-success-secondary":"border-info-primary","cursor-pointer outline-none border-dashed py-1 border-b text-sm"])},r(o.__("Price"))+" : "+r(o.nsCurrency(n.unit_price)),11,ps)]),s("div",_s,[o.allowQuantityModification(n)?(i(),d("a",{key:0,onClick:h=>o.openDiscountPopup(n,"product",_),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},[O(r(o.__("Discount"))+" ",1),n.discount_type==="percentage"?(i(),d("span",hs,r(n.discount_percentage)+"%",1)):p("",!0),O(" : "+r(o.nsCurrency(n.discount)),1)],8,bs)):p("",!0)]),s("div",fs,[o.allowQuantityModification(n)?(i(),d("a",{key:0,onClick:h=>o.changeQuantity(n,_),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Quantity"))+": "+r(n.quantity),9,ms)):p("",!0)]),s("div",ys,[s("span",vs,r(o.__("Total :"))+" "+r(o.nsCurrency(n.total_price)),1)])])])]),s("div",{onClick:h=>o.changeQuantity(n,_),class:j([o.allowQuantityModification(n)?"cursor-pointer ns-numpad-key":"","hidden lg:flex w-1/6 p-2 border-b items-center justify-center"])},[o.allowQuantityModification(n)?(i(),d("span",gs,r(n.quantity),1)):p("",!0)],10,xs),s("div",ws,r(o.nsCurrency(n.total_price)),1)],8,es))),128))]),s("div",Ps,[t.visibleSection==="both"?(i(),d("table",ks,[s("tbody",null,[t.options.ns_pos_price_with_tax==="no"?(i(),d("tr",Cs,[s("td",Ss,[s("span",Os,r(o.__("Product Taxes")),1)]),s("td",Ts,r(o.nsCurrency(t.order.products_tax_value)),1)])):p("",!0),s("tr",null,[s("td",js,[s("a",{onClick:e[8]||(e[8]=n=>o.selectCustomer()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Customer"))+": "+r(o.customerName),1)]),s("td",Ns,r(o.__("Sub Total")),1),s("td",Ds,r(o.nsCurrency(t.order.subtotal)),1)]),t.order.coupons.length>0?(i(),d("tr",Vs,[e[38]||(e[38]=s("td",{width:"200",class:"border p-2"},null,-1)),s("td",qs,[s("a",{onClick:e[9]||(e[9]=n=>o.selectCoupon()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Coupons")),1)]),s("td",Bs,r(o.nsCurrency(o.summarizeCoupons())),1)])):p("",!0),s("tr",null,[s("td",Fs,[s("a",{onClick:e[10]||(e[10]=n=>o.openOrderType()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Type"))+": "+r(o.selectedType),1)]),s("td",Hs,[s("span",null,r(o.__("Discount")),1),t.order.discount_type==="percentage"?(i(),d("span",Qs,"("+r(t.order.discount_percentage)+"%)",1)):p("",!0),t.order.discount_type==="flat"?(i(),d("span",Rs,"("+r(o.__("Flat"))+")",1)):p("",!0)]),s("td",As,[s("a",{onClick:e[11]||(e[11]=n=>o.openDiscountPopup(t.order,"cart")),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.nsCurrency(t.order.discount)),1)])]),t.order.type&&t.order.type.identifier==="delivery"?(i(),d("tr",Es,[e[39]||(e[39]=s("td",{width:"200",class:"border p-2"},null,-1)),s("td",Us,[s("a",{onClick:e[12]||(e[12]=n=>o.openShippingPopup()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Shipping")),1)]),s("td",Is,r(o.nsCurrency(t.order.shipping)),1)])):p("",!0),s("tr",Ms,[["flat_vat","variable_vat"].includes(t.options.ns_pos_vat)?(i(),d("td",Ys,[s("a",{onClick:e[13]||(e[13]=n=>o.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(t.order.tax_group.name?t.order.tax_group.name:o.__("Tax"))+": "+r(o.nsCurrency(t.order.tax_value)),1)])):(i(),d("td",Gs)),s("td",Ls,r(o.__("Total")),1),s("td",Ws,r(o.nsCurrency(t.order.total)),1)])])])):p("",!0),t.visibleSection==="cart"?(i(),d("table",zs,[s("tbody",null,[s("tr",null,[s("td",Ks,[s("a",{onClick:e[14]||(e[14]=n=>o.selectCustomer()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Customer"))+": "+r(o.customerName),1)]),s("td",Js,[s("div",Xs,[s("span",null,r(o.__("Sub Total")),1),s("span",null,r(o.nsCurrency(t.order.subtotal)),1)])])]),t.order.coupons.length>0?(i(),d("tr",Zs,[e[40]||(e[40]=s("td",{width:"200",class:"border p-2"},null,-1)),s("td",$s,[s("a",{onClick:e[15]||(e[15]=n=>o.selectCoupon()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Coupons")),1)]),s("td",eo,r(o.nsCurrency(o.summarizeCoupons())),1)])):p("",!0),s("tr",null,[s("td",to,[s("a",{onClick:e[16]||(e[16]=n=>o.openOrderType()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Type"))+": "+r(o.selectedType),1)]),s("td",so,[s("div",oo,[s("p",null,[s("span",null,r(o.__("Discount")),1),t.order.discount_type==="percentage"?(i(),d("span",ro,"("+r(t.order.discount_percentage)+"%)",1)):p("",!0),t.order.discount_type==="flat"?(i(),d("span",no,"("+r(o.__("Flat"))+")",1)):p("",!0)]),s("a",{onClick:e[17]||(e[17]=n=>o.openDiscountPopup(t.order,"cart")),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.nsCurrency(t.order.discount)),1)])])]),t.order.type&&t.order.type.identifier==="delivery"?(i(),d("tr",io,[e[42]||(e[42]=s("td",{width:"200",class:"border p-2"},null,-1)),s("td",lo,[s("a",{onClick:e[18]||(e[18]=n=>o.openShippingPopup()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Shipping")),1),e[41]||(e[41]=s("span",null,null,-1))])])):p("",!0),s("tr",ao,[s("td",uo,[t.options.ns_pos_vat!=="disabled"?(i(),d(m,{key:0},[t.order&&t.options.ns_pos_tax_type==="exclusive"?(i(),d(m,{key:0},[t.options.ns_pos_price_with_tax==="yes"?(i(),d("a",{key:0,onClick:e[19]||(e[19]=n=>o.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Tax"))+": "+r(o.nsCurrency(t.order.tax_value)),1)):t.options.ns_pos_price_with_tax==="no"?(i(),d("a",{key:1,onClick:e[20]||(e[20]=n=>o.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Tax Inclusive"))+": "+r(o.nsCurrency(t.order.tax_value)),1)):p("",!0)],64)):t.order&&t.options.ns_pos_tax_type==="inclusive"?(i(),d(m,{key:1},[t.options.ns_pos_price_with_tax==="yes"?(i(),d("a",{key:0,onClick:e[21]||(e[21]=n=>o.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Tax Included"))+": "+r(o.nsCurrency(t.order.tax_value)),1)):t.options.ns_pos_price_with_tax==="no"?(i(),d("a",{key:1,onClick:e[22]||(e[22]=n=>o.openTaxSummary()),class:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},r(o.__("Tax Included"))+": "+r(o.nsCurrency(t.order.tax_value)),1)):p("",!0)],64)):p("",!0)],64)):p("",!0)]),s("td",co,[s("div",po,[s("span",null,r(o.__("Total")),1),s("span",null,r(o.nsCurrency(t.order.total)),1)])])])])])):p("",!0)]),s("div",_o,[Object.keys(t.cartButtons).length===0?(i(!0),d(m,{key:0},k(new Array(4).fill(),n=>(i(),d("div",{class:j([o.takeRandomClass(),"animate-pulse flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center border-r flex-auto"])},e[43]||(e[43]=[s("i",{class:"mx-4 rounded-full bg-slate-300 h-5 w-5"},null,-1),s("div",{class:"text-lg mr-4 hidden md:flex md:flex-auto lg:text-2xl"},[s("div",{class:"h-2 flex-auto bg-slate-200 rounded"})],-1)]),2))),256)):p("",!0),(i(!0),d(m,null,k(t.cartButtons,n=>(i(),S(J(n),{order:t.order,settings:t.settings},null,8,["order","settings"]))),256))])]))])])])])}const Yo=P(wt,[["render",Bo]]);export{Yo as default};
